{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vehicle Rental Service</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Alertify -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/alertify.min.css"/>
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/themes/bootstrap.min.css"/>

    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/74241ca4bb.js" crossorigin="anonymous"></script>

    <style>
        body {
            font-family: 'Inter', 'Segoe UI', Roboto, Arial, sans-serif;
            font-size: 15px;
        }

        .navbar {
            font-size: 14.5px;
        }

        .navbar-brand {
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .navbar .nav-link {
            font-weight: 500;
            position: relative;
            transition: color 0.25s ease;
        }

        .navbar .nav-link:hover {
            color: #ffc107;
        }

        /* underline hover */
        .navbar .nav-link::after {
            content: "";
            position: absolute;
            width: 0;
            height: 2px;
            left: 50%;
            bottom: 0;
            background-color: #ffc107;
            transition: width 0.3s ease, left 0.3s ease;
        }

        .navbar .nav-link:hover::after {
            width: 100%;
            left: 0;
        }

        /* Dropdown hover (desktop only) */
        @media (min-width: 992px) {
            .navbar .dropdown:hover .dropdown-menu {
                display: block;
                margin-top: 0;
            }
        }
    </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">

        <a class="navbar-brand" href="{% url 'home' %}">VehicleRent</a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">

            <!-- LEFT LINKS -->
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">

                <li class="nav-item">
                    <a class="nav-link" href="{% url 'home' %}">Home</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="{% url 'vehicles' %}">Vehicles</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="#">About</a>
                </li>

                {% if user.is_authenticated and not user.is_staff %}
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'my_bookings' %}">My Bookings</a>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button"
                       data-bs-toggle="dropdown">
                        Vehicles
                        {% if unread_notifications > 0 %}
                            <span class="badge bg-danger rounded-pill ms-1"
                                style="font-size: 10px;">
                                {{ unread_notifications }}
                            </span>
                        {% endif %}
                        
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="dropdown-item" href="{% url 'owner_bookings' %}">
                                Incoming Bookings
                                {% if unread_notifications > 0 %}
                                    <span class="badge bg-danger rounded-pill ms-1"
                                        style="font-size: 10px;">
                                        {{ unread_notifications }}
                                    </span>
                                {% endif %}
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="{% url 'my_vehicles' %}">My Vehicles</a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="{% url 'apply_vehicle' %}">
                                Add Vehicle
                            </a>
                        </li>
                    </ul>
                </li>
                {% endif %}

                {% if user.is_staff %}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button"
                       data-bs-toggle="dropdown">
                        Admin Panel
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Dashboard</a></li>
                        <li><a class="dropdown-item" href="#">Vehicles</a></li>
                        <li><a class="dropdown-item" href="#">Bookings</a></li>
                        <li><a class="dropdown-item" href="#">Users</a></li>
                    </ul>
                </li>
                {% endif %}
            </ul>

            <!-- RIGHT LINKS -->
            <ul class="navbar-nav">
                {% if user.is_authenticated %}
                <li class="nav-item">
                    <span class="nav-link disabled text-light">
                        <i class="fa-solid fa-user"></i> {{ user.username }}
                    </span>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-danger" href="{% url 'logout' %}">
                        Logout
                    </a>
                </li>
                {% else %}
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'login' %}">Login</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'register' %}">Register</a>
                </li>
                {% endif %}
            </ul>

        </div>
    </div>
</nav>

<!-- PAGE CONTENT -->
{% block content %}{% endblock %}


<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Alertify JS -->
<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/alertify.min.js"></script>

<style>
/* Responsive alertify */
.alertify-notifier {
    width: auto !important;
    max-width: 90vw;
}

.alertify-notifier .ajs-message {
    white-space: normal;
    text-align: center;
}
</style>

{% if messages %}
<script>
    alertify.set('notifier', 'position', 'top-center');

    {% for message in messages %}
        {% if message.tags == 'error' %}
            alertify.error("{{ message|escapejs }}");
        {% else %}
            alertify.success("{{ message|escapejs }}");
        {% endif %}
    {% endfor %}
</script>
{% endif %}


</body>
</html>
